import textwrap
import unittest
from run2 import solve
from parameterized import parameterized


class TestMazeRobots(unittest.TestCase):
    def grid_input(self, input: str) -> int:
        grid = [list(line) for line in
                textwrap.dedent(input).strip().splitlines()]
        return solve(grid)

    @parameterized.expand([
        ("example1", """
         #######
         #a.#Cd#
         ##@#@##
         #######
         ##@#@##
         #cB#Ab#
         #######
         """, 8),

        ("example2", """
         ###############
         #d.ABC.#.....a#
         ######@#@######
         ###############
         ######@#@######
         #b.....#.....c#
         ###############
         """, 24),

        ("example3", """
         #############
         #DcBa.#.GhKl#
         #.###@#@#I###
         #e#d#####j#k#
         ###C#@#@###J#
         #fEbA.#.FgHi#
         #############
         """, 32),

        ("one_step", """
             @a....@
             .......
             @.....@
             """, 1),

        ("zero_step", """
             @@
             @@
             """, 0),

        ("line1", """
             @@@@
             """, 0),

        ("line2", """
             @@@@aAbBC
             """, 3),

        ("big_grid", """
        #################################################################################
        #...#.......#....a..#...........#..e....#.....#...#...#...........#.............#
        #.#.#.#####.#.#####.#.#######.###.###.#.#.###.#.#.###.#.#########.#.###.#######.#
        #.#.#.#.#...#.#.K...#...#...#.....#.#.#.#.#.....#.#...#t......#...#.#...#.......#
        #.###B#.#.#.#.#.#######.###.#######.#.###.#######.#.#########.#.#####.###.#######
        #.#q..#.#.#.#.#...#.....#...#.......#...#...#.#...#.........#.#.......#.#.#.....#
        #.#.###.#.#.#.###.#.#####.#.#.#####.###.###.#.#.#####.#######.#########.#.###.#.#
        #...#...#.#.#...#.#.......#...#.....#...#...#.........#.....#.......#.#...#m..#.#
        #.#####.#.#####.#.#######.#########.#.###F#############.###.###.###.#.#.###.#####
        #...#...#.......#.......#.#......h#.#...#.#.....#.......#.....#.#...#.#.#.......#
        ###.#.###########.#####.#.#.#####.#####.#.#.###.#.#####.#####.#.#.###G#.###.###.#
        #.#.#.......#...#...#...#.#...J.#.#.....#.#...#.#.....#.#...#.#.#.#...#...#...#.#
        #.#.#####.###.#.###.#####.#####.#.#.###.#.###.#.#####.#.#.#.#.###.#.#.###.#####S#
        #w#...#...#...#...#...#...#...#.#...#...#.#...#.....#.#.#.#.#.....#.#...#.......#
        #.###.#.###.#####.###.#.#####.#.#####.###.#.###.###.#.###.#.#######.###.#######.#
        #...#...#...#.....#...#.#...#.#...#.#.#.#.#.#.#.#...#.....#...#...#.#.#.........#
        #.#####.#.###.#####.###.#.#.#.###.#.#.#.#.#.#.#.###.#########.#.#.#.#.###########
        #.......#...#.....#.#.....#...#.#.#...#.#...#.#...#.....#...#.#.#.#.....#.......#
        #C#########.#####.#.#.#######.#.#.###.#.#.###.###.#####.#.###.#.#######.###.###.#
        #.#.......#.#.#...#...#...#.....#...#...#.......#.#.....#.#...#.....#.#...#...#.#
        #.###.#.#.#.#.#.###.###.#.#########.###.#####.###.#.#####.#.#####.#.#.###.###.###
        #...#.#.#.#.#.#.#y..#...#...#.....#.#...#.....#...#.#.....#...#...#.....#...#...#
        ###.###.#I#.#.#.###########.#.###.#.#####.#####.###.#.###.#####.###########.#.#.#
        #...#...#.#.#.#...........#...#...#.#...#...#...#.#...#...#.....#.........#.#.#.#
        #.###.###.#.#.#####.###########.###.#.#.#####.###.#.#####.###.###.#######.#.###.#
        #.....#...#...#...#.............#.....#.#.....#...#.#...#.....#...#.....#...#...#
        #####.#######.#.#.###############.#####.#.#######.#.#.#.#####.#.###.###.#####.###
        #.....#.....#...#.#...#.............#...#.......#...#.#.#.....#.#.#.#.#.........#
        #.#####.###.#####.#.###.###########.#.###.#####.#####.#.#######.#.#.#.#########.#
        #...#.#.#.#.......#...........#...#.#...#.....#.......#...#.....#...#.....#...#.#
        ###.#.#.#.###############.#####.#.#.###.#####.###########.#.#######.###.###.#.#.#
        #...#.#...#.......#.....#.#.....#.#...#.#.....#...#.....#...#.....#.#...#...#...#
        #.###.###.#.#####.#.###.###.#####.#####.#.#####.###.###.#####.###.#.#.###.#####.#
        #.#.....#.#...#.....#...#...#.....#.....#...#.......#...#.....#.#.#...#...#.....#
        #.###L#.#.#.#.#######.###.###.#####.###.###.#.#######.#.###.###.#.###.#.###.#####
        #o..#.#.#.#.#.....#.#.#...#.#...#...#.#.#.#.#.....#...#.....#.#...#...#.#.......#
        ###.###.#.#######.#.#.#.#.#.###.#.###.#.#.#.#######.#########.#.#######.#######.#
        #.#...#.#.......#.#.#.#.#.#.#...#.#...#.#.#.#...#...#.........#.#.....#.......#.#
        #.###.#.#######.#.#.#.###.#.#.###.#.###.#.#.#.#.#.###.#######.#.#.###.#######.#.#
        #.............#...#.......#.......#....@#@....#...#.........#.....#...........#.#
        #################################################################################
        #.....#.....#.#.........#.#...#.....#..@#@......#..u........#...#.......#.....Q.#
        #.#.###.#.#.#.#.#######.#.#.#.#.#.###.#.#.#.###.#.#########.###.#.#.###.#######.#
        #.#.#...#.#.#.#.....#...#.R.#.#.#.....#.#.#...#...#.......#r....#.#...#.........#
        #.#.#.###.#.#.#####.###.#####.#.#######.#.###.#######.###.#####.#.###.#####.#####
        #.#...#...#.......#...#.....#.#.#.#...#.#.#.#...#...#.#...#.....#b#.#...#...#..c#
        #.#####.#############.#####.#.#.#.#.#.#.#.#.###.#.#.#.#.###.#####.#.###.#####.#.#
        #p#...V.#..x#.......#...#...#.....#.#...#.#...#.#.#...#...#.#.#...#...#.....#.#.#
        ###.#####.#.#.#####.###.#.###U#####.###.#.#.#.#.#.#######.#.#.#.###.#.#####.#.#.#
        #...#.....#.....#...#...#.#.#.#.....#.#.#...#.#.#.#...#.#.#...#...#.#.....#...#.#
        #.###.###########.###.###.#.#.#.#####.#.#.#####.#.#.#.#.#.###.###.#.#####.#####.#
        #.......#.......#...#.#.#.#...#...#.....#.#...#.#.#.#.#...#...#.#.#.....#...#.#.#
        #.#####.#.#####.###.#.#.#.#.#####.#######.#.#.#.#.#H#.###.#.###.#.#.###.###.#.#.#
        #.#...#.#.#...#.....#.#...#.....#...#...#.#.#...#.#.#...#.#.....#.#...#.#.#...#.#
        #.#.#.###.#.#######.#.###.#########.#.#.###.#####.#.###.###.#####.#####.#.###.#.#
        #.#.#.....#...#.....#...#.#.......#...#.#...#.....#.#.#.....#...#.......#.....#.#
        #.#.#########.#.#######.#.#.#####.#####.#.###.#.###.#.#######.#.#########.#####.#
        #.#.........#.#.#.#.....#...#...#.....#.#...#.#.#.........#...#...#.....#...#...#
        #.#########.#.#.#.#.#########.#.#####.#.#.#.#.###.#########.###.###.#.#####.#.#.#
        #.#.......#.#.#...#.#.......#.#.....#.#.#.#.#.....#.#.........#.#...#.#.....#.#.#
        #.#######.#.#.###.#.###.#####.#####.#.#.#.#.###.###.#.#########.#.###.#.#####.#.#
        #......z..#.#.#...#...#.....#.#.....#.#.#.#...#.....#.......#.#.#.#.#...#...#.#.#
        #########.#.#.#.#######.###.#.#.###.#.#.#.###.###########.###.#.#.#.#######.#.#.#
        #.#.......#.#...#.....#.#.#.#.#.#...#.#.#.#.#.............#...#.#.......#...#.#.#
        #.#.#######.#.###.#.#.#.#.#.#.#.#.###.#.#.#.###############.###.#######.#.###.#.#
        #...#.......#...#.#.#.#...#...#.#...#.#.#....j#...#...#....d#...#...#...#...#.#.#
        #.###.#########.###.#.###.#####.#####.#.#####.#.###.#.#.#######.#.#.#.#####.#.#.#
        #...#.#.......#.#...#...#...#.#.....#...#...#.#.....#.#.Z.#.....#.#...#.....#.#.#
        #D###.#####.###.#.#####.###.#.#####.###.###.#.#######.###.###.###.#######.###.#.#
        #.#...#...#..n#...#.N.#.#...#.....#.....#...#.....#...#.#...#.....#.....#.#...#.#
        ###.###.#.###.#######.#.#.#####.#.#######.#######.#.#.#.###.#.#####.###.#.#.###W#
        #...#...#.............#.#.....#.#.....M.#.#.......#.#...#...#.......#.....#...#.#
        #.###.#.###############.#####.###.#####.#.#.#######.###.#.#######.#####.#####.#.#
        #.#.P.#...#...#.......#.#...#.....#...#.#.#...#.....#...#...#.#...#...#.#.....#i#
        #.#######.#.#.#.#####.#.#.#.#######.#.#.#.###.###.###.#####.#.#.###.#.###.#####.#
        #.......#...#.......#...#.#.......#.#...#...#....f#.E.#...#.#.....#.#.#...#.O.#.#
        #.#####.#################.###.#####.#####.#########.#####.#.#######X#.#.###.#.###
        #.#.#...#...#...T...#.A.#...#..k..#.#...#.#...#...#.#...#.#.....#...#.#.....#...#
        #.#.#.###.#.#.#####.#.#.###.#####.#.#.#.#.#.#.#.#.#.#.#.#.#####.#.###.#########.#
        #...#.....#.......#...#.........#.Y...#.#..s#...#..g..#.......#v..#............l#
        #################################################################################
        """, 1640),
    ])
    def test_maze(self, name, grid_str, expected):
        self.assertEqual(self.grid_input(grid_str), expected)


if __name__ == "__main__":
    unittest.main()
